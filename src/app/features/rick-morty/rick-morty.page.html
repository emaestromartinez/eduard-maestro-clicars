<main class="page">
  <form
    [formGroup]="filterForm"
    (ngSubmit)="applyFilters()"
    class="filters"
    role="form"
    aria-labelledby="filters-title"
  >
    <h2 id="filters-title" class="visually-hidden">Filtros de personajes</h2>

    <div class="filters-group">
      <input id="name" type="text" formControlName="name" placeholder=" " />
      <label for="name">Nombre del personaje</label>
    </div>

    <div class="filters-group">
      <select id="status" formControlName="status">
        <option value="">Todos</option>
        <option *ngFor="let status of statusOptions" [value]="status">
          {{ status | titlecase }}
        </option>
      </select>
      <label for="status">Estado</label>
    </div>

    <div class="filters-group">
      <select id="gender" formControlName="gender">
        <option value="">Todos</option>
        <option *ngFor="let gender of genderOptions" [value]="gender">
          {{ gender | titlecase }}
        </option>
      </select>
      <label for="gender">Género</label>
    </div>

    <div class="filters-group">
      <input id="species" type="text" formControlName="species" placeholder=" " />
      <label for="species">Especie</label>
    </div>

    <div class="filters-group">
      <input id="type" type="text" formControlName="type" placeholder=" " />
      <label for="type">Tipo</label>
    </div>

    <button type="submit" class="filters__submit">Filtrar</button>
  </form>

  <!-- LOADING -->
  @if (loading()) {
    <div class="page__message" role="status" aria-live="polite">Cargando…</div>
  }

  <!-- ERROR -->
  @if (error()) {
    <div class="page__message page__message--error" role="alert" aria-live="assertive">
      {{ error() }}
    </div>
  }

  <!-- GRID y PAGINACIÓN -->
  @if (!loading() && !error()) {
    <section class="page__grid-wrapper" role="region" aria-label="Lista de personajes">
      <div class="page__grid">
        <app-character-card
          *ngFor="let c of characters()"
          [character]="c"
          role="listitem"
        ></app-character-card>
      </div>
    </section>

    <div class="pagination">
      <button (click)="prevPage()" [disabled]="globalPage() === 1" aria-label="Página anterior">
        Anterior
      </button>
      <span aria-live="polite">Página {{ globalPage() }} de {{ totalChunks() }}</span>
      <button
        (click)="nextPage()"
        [disabled]="globalPage() === totalChunks()"
        aria-label="Página siguiente"
      >
        Siguiente
      </button>
    </div>
  }
</main>
